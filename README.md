# Бесконечный кроссворд

Автоматически генерируемый бесконечный кроссворд с интерактивной навигацией.

## Идея проекта

Интерактивный кроссворд на бесконечном холсте, который автоматически генерируется алгоритмом. Пользователь может перемещаться по кроссворду с помощью мыши или клавиатуры, исследуя сгенерированные слова.

### Особенности

- **Бесконечная генерация** — алгоритм расширяет кроссворд, добавляя слова перпендикулярно существующим
- **Жадный алгоритм** — выбирает слова с максимальным количеством пересечений
- **Ленивый рендеринг** — отрисовываются только видимые клетки
- **Плавная навигация** — управление камерой с интерполяцией

## Структура проекта

```
crossword/
├── frontend/
│   ├── index.html      # HTML страница с canvas
│   ├── interface.js    # Рендеринг и управление камерой (Paper.js)
│   ├── generation.js   # Класс Crossword для отображения
│   └── main.js         # Инициализация и загрузка с API
├── backend/
│   ├── package.json    # Зависимости Node.js
│   ├── server.js       # Express сервер
│   ├── generation.js   # Алгоритм генерации кроссворда
│   └── wordsBank.js    # Банк русских слов
└── README.md
```

## Запуск

### Backend

```bash
cd backend
npm install
npm start
```

Сервер запустится на `http://localhost:3000`

### Frontend

Открыть `frontend/index.html` в браузере или использовать live server.

**Важно:** Бэкенд должен быть запущен перед открытием фронтенда.

## API

### GET /api/generate

Генерирует кроссворд.

**Параметры:**
- `count` (number) — количество слов для генерации (default: 30)
- `seed` (string) — начальное слово (default: "кроссворд")

**Пример:**
```
GET /api/generate?count=50&seed=программа
```

**Ответ:**
```json
{
  "words": [
    { "word": "кроссворд", "x": 0, "y": 0, "direction": "horizontal" },
    { "word": "время", "x": 5, "y": -4, "direction": "vertical" }
  ],
  "firstLetterCandidates": [
    { "x": 0, "y": -1, "direction": "vertical" }
  ]
}
```

## Управление

- **Стрелки** — плавное перемещение камеры
- **Мышь (drag)** — перетаскивание

## Алгоритм генерации

1. Начинаем с seed-слова в позиции (0, 0)
2. Для каждой буквы генерируем позиции-кандидаты перпендикулярно
3. Для каждого кандидата перебираем слова из банка
4. Оцениваем размещение: базовый score = длина слова + бонус за пересечения
5. Выбираем слово с максимальным score
6. Блокируем соседние клетки (правила кроссворда)
7. Добавляем новые кандидаты и повторяем

## Тесты

Selenium тесты с headless Chrome и автоматическими скриншотами.

### Запуск тестов

```bash
cd tests
./run_tests.sh
```

Или вручную:

```bash
cd tests
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
pytest test_crossword.py -v
```

**Важно:** Сервер должен быть запущен перед тестами.

### Что тестируется

- Загрузка страницы
- Рендеринг кроссворда
- Движение камеры (клавиатура и мышь)
- API генерации
- Связность слов

Скриншоты сохраняются в `tests/screenshots/`.

## Технологии

- **Frontend:** Paper.js (canvas рендеринг)
- **Backend:** Node.js, Express
- **Тесты:** Python, Selenium, pytest
- **Без внешних БД** — всё в памяти
